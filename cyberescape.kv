ScreenManagement:
    HomePage:
    HowToPlay:
    Phase1:
    Phase2:
    Phase3:
    LostPage:
    WonPage:

<HomePage>:
    name: "homepage"

    FloatLayout:

        Image:
            source: "images/cyberescape_logo2.png"
            size: (20, 20)
            pos_hint: {"center_x":0.5, "center_y": 0.8}

        MDLabel:
            text:"Bem-vindo(a)!"
            font_style: "H5"
            halign: "center"
            pos_hint: {"center_x":0.5, "center_y": 0.6}

        MDLabel:
            text: "Desafie-se, Proteja-se, Escape!"
            font_style: "Caption"
            halign: "center"
            pos_hint: {"center_x":0.5, "center_y": 0.7}

        MDRoundFlatButton:
            text: "Come√ßar"
            font_size: 18
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.4}
            on_release: app.root.current = "phase1"

        MDRoundFlatButton:
            text: "Como Jogar"
            font_size: 18
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.3}
            on_release: app.root.current = "how_to_play"

<HowToPlay>:
    name: "how_to_play"

    FloatLayout:

        MDLabel:
            text:"Como Jogar"
            font_style: "H5"
            bold: True
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}

        MDLabel:
            text: "Welcome to CyberEscape! Follow these steps to play: 1. Enter your name in the homepage.2. Click 'Start' to begin the quiz.3. Answer the questions within the time limit.4. Solve the Caesar Cipher in Phase 2.5. Navigate through the case study in Phase 3.6. Make decisions to prevent a cyber attack.7. Reach the end and see if you succeeded!"
            font_size: "16sp"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 15

        MDRoundFlatButton:
            text: "Retornar"
            size_hint: None, None
            pos_hint:{"center_x":0.5, "center_y": 0.4}
            on_release: app.root.current = "homepage"

        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}

<Phase1>:
    name: "phase1"

    FloatLayout:
        size: root.width, root.height
        
        MDLabel:
            text: "Question time"
            font_style: "H5"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}

        MDLabel:
            text: "What is the primary goal of cybersecurity?"
            font_size: "22sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.65}

        MDRaisedButton:
            text: "Protecting Information"
            size_hint: None, None
            size:200, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_release: root.check_answer("correct")

        MDRaisedButton:
            text: "Making Systems Faster"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.42}
            on_release: root.check_answer("incorrect")

        MDRaisedButton:
            text: "Selling Software"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.34}
            on_release: root.check_answer("incorrect")

        MDRaisedButton:
            text: "Creating Websites"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.26}
            on_release: root.check_answer("incorrect")
        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.1}



<Phase2>:
    name: "phase2"

    FloatLayout:
        size: root.width, root.height
        MDLabel:
            text: "Caesar Cipher"
            font_style:"H5"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}


        MDLabel:
            text: "The Caeser cipher is a simple encryption technique that was used  by Julius Caesar to send secret messages to his allies. It works by shifting the letter in the plaintext message by a certain number of positions, known as the 'shift'. Use brute force to try and decrypt the message bellow:"
            font_style: "Body1"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.7}
            padding: 15

        MDLabel:
            id: encrypted_label
            text: root.encrypted_message
            font_size: "22sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

        MDTextField:
            id: decryption_input
            multiline: False
            height: self.font_size * 2
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.4}

        MDRoundFlatButton:
            text: "Submit"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.3}
            on_release: root.check_decryption(decryption_input.text)

        Image:
            source: "images/caeser.png"
            size_hint: (None, None)
            size: dp(40), dp(40)
            pos_hint: {"center_x": 0.15, "center_y": 0.1}

        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.8, "center_y": 0.1}

<Phase3>:

    name: "phase3"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Case Study"
            font_style:"H5"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}

        MDLabel:
            text: root.text_scenario  # This references the scenario property in Phase3
            font_size: "16sp"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.75}
            markup: True
            padding: 15

        MDRaisedButton:
            text: "1. Analyze system logs"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.4}
            on_release: root.make_decision(1)
        MDRaisedButton:
            text: "2. Initiate a counter-attack"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.32}
            on_release: root.make_decision(2)
        MDRaisedButton:
            text: "3. Collaborate with experts"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.24}
            on_release: root.make_decision(3)
        MDRaisedButton:
            text: "4. Disconnect the server"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.16}
            on_release: root.make_decision(4)

        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.06}

<WonPage>:
    name: "winner_page"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Congratulations!"
            font_style: "H4"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}


        MDLabel:
            text: "You successfully completed CyberEscape!"
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}

        MDFillRoundFlatButton:
            text: "Restart Game"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_release: app.root.current = homepage

        Image:
            source: "images/cyberescape_logo2.png"
            size_hint: (20, 20)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}

<LostPage>:
    name: "lost_page"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Sorry, you lost!"
            font_style: "H4"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}


        MDLabel:
            text: "Better luck next time. Keep learning and trying!"
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}

        MDFillRoundFlatButton:
            text: "Restart Game"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_release: app.root.current = homepage

        Image:
            source: "images/cyberescape_logo2.png"
            size_hint: (20, 20)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}