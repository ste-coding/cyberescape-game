ScreenManagement:
    HomePage:
    HowToPlay:
    Phase1:
    Phase2:
    Phase3:
    LostPage:
    WonPage:

<HomePage>:
    name: "homepage"

    FloatLayout:

        Image:
            source: "images/cyberescape_logo2.png"
            size: (20, 20)
            pos_hint: {"center_x":0.5, "center_y": 0.8}

        MDLabel:
            text:"Bem-vindo(a)!"
            font_style: "H5"
            halign: "center"
            pos_hint: {"center_x":0.5, "center_y": 0.55}

        MDLabel:
            text: "Desafie-se, Proteja-se, Escape!"
            font_style: "Caption"
            halign: "center"
            pos_hint: {"center_x":0.5, "center_y": 0.7}

        MDRoundFlatButton:
            text: "Começar"
            font_size: 18
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.4}
            on_release: app.root.current = "phase1"

        MDRoundFlatButton:
            text: "Como Jogar"
            font_size: 18
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.3}
            on_release: app.root.current = "how_to_play"

<HowToPlay>:
    name: "how_to_play"

    FloatLayout:

        MDLabel:
            text:"Como Jogar"
            font_style: "H5"
            bold: True
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}

        MDLabel:
            text: "Bem-vindo(a) ao CyberEscape! Siga estes passos para jogar:\n1. Clique em 'Começar'.\n2. Responda às perguntas dentro do limite de tempo.\n3. Desencripte uma mensagem secreta dentro do tempo e clique em 'Enviar'.\n4. Analise o estudo de caso e tome a decisão certa dentro do limite de tempo, o resultado será mostrado após você escolher sua resposta."
            font_size: "16sp"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 15

        MDRoundFlatButton:
            text: "Retornar"
            size_hint: None, None
            pos_hint:{"center_x":0.5, "center_y": 0.3}
            on_release: app.root.current = "homepage"

        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}

<Phase1>:
    name: "phase1"

    FloatLayout:
        size: root.width, root.height
        
        MDLabel:
            text: "Quiz"
            font_style: "H5"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}

        MDLabel:
            text: "Qual é o objetivo principal da cibersegurança?"
            font_size: "22sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.65}

        MDRaisedButton:
            text: "Proteger informação"
            size_hint: None, None
            size:200, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_release: root.check_answer("correct")

        MDRaisedButton:
            text: "Fazer sistemas mais rápidos"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.42}
            on_release: root.check_answer("incorrect")

        MDRaisedButton:
            text: "Criar e vender software"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.34}
            on_release: root.check_answer("incorrect")

        MDRaisedButton:
            text: "Criar websites"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.26}
            on_release: root.check_answer("incorrect")
        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.1}



<Phase2>:
    name: "phase2"

    FloatLayout:
        size: root.width, root.height
        MDLabel:
            text: "Cifra de César"
            font_style:"H5"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}


        MDLabel:
            text: "A cifra de César é uma técnica de criptografia simples usada por Júlio César para enviar mensagens secretas a seus aliados. Ela funciona deslocando a letra da mensagem de texto simples em um certo número de posições, conhecido como 'shift'. Use força bruta para tentar descriptografar a mensagem abaixo:"
            font_style: "Body1"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.7}
            padding: 15

        MDLabel:
            id: info_label
            text: root.info_label
            font_style: "Body1"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

        MDTextField:
            id: input_text
            hint_text: "Digite a mensagem encriptada"
            multiline: False
            height: self.font_size * 2
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.35}

        MDRoundFlatButton:
            text: "Enviar"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.28}
            on_release: root.check_encryption(input_text)

        Image:
            source: "images/caeser.png"
            size_hint: (None, None)
            size: dp(40), dp(40)
            pos_hint: {"center_x": 0.15, "center_y": 0.1}

        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.8, "center_y": 0.1}

<Phase3>:

    name: "phase3"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Estudo de Caso"
            font_style:"H5"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.95}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.95}

        MDLabel:
            text: root.text_scenario  # This references the scenario property in Phase3
            font_size: "16sp"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.73}
            markup: True
            padding: 15

        MDRaisedButton:
            text: "1. Analisar registros do sistema"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.4}
            on_release: root.make_decision(1)
        MDRaisedButton:
            text: "2. Iniciar um contra-ataque"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.32}
            on_release: root.make_decision(2)
        MDRaisedButton:
            text: "3. Colaborar com especialistas"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.24}
            on_release: root.make_decision(3)
        MDRaisedButton:
            text: "4. Desconectar o servidor"
            size_hint: None, None
            size: 300, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.16}
            on_release: root.make_decision(4)

        Image:
            source: "images/cyberescape_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.06}

<WonPage>:
    name: "winner_page"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Mandou bem!"
            font_style: "H4"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}


        MDLabel:
            text: "Você completou com sucesso o CyberEscape!"
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 15

        MDFillRoundFlatButton:
            text: "Jogar de novo"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_release: app.reset_game()

        Image:
            source: "images/cyberescape_logo2.png"
            size_hint: (20, 20)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}

<LostPage>:
    name: "lost_page"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Não foi dessa vez!"
            font_style: "H4"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}


        MDLabel:
            text: "Boa sorte na próxima vez. Continue aprendendo e tentando!"
            font_size: "18sp"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 15

        MDFillRoundFlatButton:
            text: "Jogar de novo"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_release: app.reset_game()

        Image:
            source: "images/cyberescape_logo2.png"
            size_hint: (20, 20)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}