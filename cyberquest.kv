ScreenManagement:
    Welcome:
    HomePage:
    HowToPlay:
    Phase1:
    Phase2:
    Phase3:
    LostPage:
    WonPage:

<Welcome>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "welcome_screen"
    FloatLayout:
        Image:
            source: "assets/images/cyberquest_logo.png"
            size_hint: (None, None)
            size: (dp(400), dp(400))
            pos_hint: {"center_x": 0.5, "center_y": 0.7}
        
        MDLabel:
            text: "Navegue na segurança\nJogue no conhecimento"
            font_size: 28
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            valign: "middle"
            pos_hint: {"center_x": 0.5, "center_y": 0.58}
            color: 1 , 0.412 , 0.706 , 1

        MDTextField:
            id: name_input
            hint_text: "Como deseja ser chamado(a)?"
            pos_hint: {"center_x": 0.5, "center_y": 0.45}
            size_hint_x: 0.8
            size_hint_y: 0.08
            mode: "rectangle"
            font_name: "assets/font/computer-says-no.ttf"
            font_size: 24

        MDRoundFlatButton:
            id: submit_button
            text: "Entrar"
            font_name: "assets/font/computer-says-no.ttf"
            font_size: 32
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.3}
            on_release: root.submit_name() 
<HomePage>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1 
        Rectangle:
            pos: self.pos
            size: self.size
    name: "homepage"

    FloatLayout:
        Image:
            source: "assets/images/cyberquest_logo.png"
            size_hint: (None, None)
            size: (dp(400), dp(400))
            pos_hint: {"center_x": 0.5, "center_y": 0.7}

        MDLabel:
            id: welcome_label
            text: "Bem-vindo(a)!"
            font_size: 34
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.56}

        MDRoundFlatButton:
            text: "Começar"
            font_size: 36
            font_name: "assets/font/computer-says-no.ttf"
            size_hint_x: 0.7
            pos_hint: {"center_x": 0.5, "center_y": 0.45}
            on_release: app.root.current = "phase1"

        MDRoundFlatButton:
            text: "Como Jogar"
            font_size: 36
            font_name: "assets/font/computer-says-no.ttf"
            size_hint_x: 0.7
            pos_hint: {"center_x": 0.5, "center_y": 0.35}
            on_release: app.root.current = "how_to_play"
        
        MDIconButton:
            icon: "volume-high" if root.music_on else "volume-off"
            pos_hint: {"center_x": 0.76, "center_y": 0.913}
            on_release: root.toggle_music()
            user_font_size: "24sp"

        MDSwitch:
            id: sound_switch
            size_hint: None, None
            size: dp(48), dp(48)
            pos_hint: {"center_x": 0.85, "center_y": 0.9}
            active: root.music_on
            on_active: root.toggle_music()

        MDLabel:
            text: "Som: " + ("Ligado" if sound_switch.active else "Desligado")
            pos_hint: {"center_x": 0.1, "center_y": 0.1}
            font_name: "assets/font/computer-says-no.ttf"
            halign: "right"
            theme_text_color: "Secondary"

<HowToPlay>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "how_to_play"

    FloatLayout:

        MDLabel:
            text:"Como Jogar"
            font_style: "H5"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            bold: True
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}

        MDLabel:
            text: "Bem-vindo à CyberQuest! Embarque numa jornada de três etapas para conhecer mais sobre Cybersegurança:\n1. Toque em 'Começar' para iniciar seu desafio.\n2. Responda perguntas de escolha múltipla sobre segurança digital.\n3. Criptografe uma mensagem utilizando uma técnica simples antes que o tempo acabe.\n4. Desafio de Decisão: Leia um breve cenário e escolha a ação mais segura. Sua escolha determina seu sucesso!"
            font_size: 24
            font_name: "assets/font/computer-says-no.ttf"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 20

        MDRoundFlatButton:
            text: "Retornar"
            size_hint: None, None
            pos_hint:{"center_x":0.5, "center_y": 0.3}
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            on_release: app.root.current = "homepage"

        Image:
            source: "assets/images/cyberquest_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}

<Phase1>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "phase1"

    FloatLayout:
        size: root.width, root.height
        
        MDLabel:
            text: "Quiz time!"
            font_style: "H5"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}

        MDLabel:
            id: question_label
            font_size: 36
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            size_hint_y: None
            pos_hint: {"center_x": 0.5, "center_y": 0.76}
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1

        BoxLayout:
            padding: 20
            orientation: 'vertical'
            id: answers_layout
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            size_hint_y: None
            pos_hint: {"center_x": 0.5, "center_y": 0.4}
            adaptive_height: True
            spacing: 20

        Image:
            source: "assets/images/cyberquest_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.1}



<Phase2>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "phase2"

    FloatLayout:
        size: root.width, root.height
        MDLabel:
            text: "Cifra de César"
            font_style:"H5"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.9}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.9}


        MDLabel:
            text: "A cifra de César é uma técnica de criptografia utilizada por Júlio César para enviar mensagens secretas a seus aliados. Ela funciona deslocando a letra da mensagem de texto em um certo número de posições, conhecido como 'shift'. Use força bruta para tentar encriptografar a mensagem utilizando o shift abaixo:"
            font_style: "Body1"
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.7}
            padding: 15

        MDLabel:
            id: info_label
            text: root.info_label
            font_style: "Body1"
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

        MDRoundFlatButton:
            text: "Enviar"
            size_hint: None, None
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            pos_hint: {"center_x": 0.5, "center_y": 0.28}
            on_release: root.check_encryption()


        Image:
            source: "assets/images/caeser.png"
            size_hint: (None, None)
            size: dp(40), dp(40)
            pos_hint: {"center_x": 0.15, "center_y": 0.1}

        Image:
            source: "assets/images/cyberquest_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.8, "center_y": 0.1}

<Phase3>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "phase3"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Estudo de Caso"
            font_style:"H5"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.95}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.95}

        MDLabel:
            text: root.text_scenario
            font_size: 34
            font_name: "assets/font/computer-says-no.ttf"
            halign: "justify"
            pos_hint: {"center_x": 0.5, "center_y": 0.74}
            markup: True
            padding: 15
        
        MDLabel:
            id: consequences_label
            font_size: 24
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.52}
            markup: True
            padding: [0, 5]

        MDRaisedButton:
            id: decision1
            text: ""
            opacity: 0 
            disabled: True
            size_hint: None, None
            adaptive_height: True
            pos_hint: {"center_x": 0.5, "center_y": 0.4}
            font_size: 24
            font_name: "assets/font/computer-says-no.ttf"
            on_release: root.process_decision(0)

        MDRaisedButton:
            id: decision2
            text: ""
            opacity: 0
            disabled: True
            size_hint: None, None
            adaptive_height: True
            pos_hint: {"center_x": 0.5, "center_y": 0.32}
            font_size: 24
            font_name: "assets/font/computer-says-no.ttf"
            on_release: root.process_decision(1)

        MDRaisedButton:
            id: decision3
            text: ""
            opacity: 0 
            disabled: True 
            size_hint: None, None
            adaptive_height: True
            pos_hint: {"center_x": 0.5, "center_y": 0.24}
            font_size: 24
            font_name: "assets/font/computer-says-no.ttf"
            on_release: root.process_decision(2)

        MDRaisedButton:
            id: decision4
            text: ""
            opacity: 0
            disabled: True
            size_hint: None, None
            adaptive_height: True
            pos_hint: {"center_x": 0.5, "center_y": 0.16}
            font_size: 24
            font_name: "assets/font/computer-says-no.ttf"
            on_release: root.process_decision(3)

        Image:
            source: "assets/images/cyberquest_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.06}

<Phase4>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "phase4"

    FloatLayout:
        size: root.width, root.height
        
        MDLabel:
            text: "Phishing"
            font_style:"H5"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.25, "center_y": 0.95}

        MDLabel:
            id: timer_label
            text: str(root.timer)
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.9, "center_y": 0.95}

        MDLabel:
            id: message_label
            text: ""
            font_size: 38
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            valign: "middle"
            size_hint: (.8, .2)
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
        
        MDLabel:
            id: email_text_label
            text: ""
            font_size: 38
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            size_hint_y: None
            height: dp(200)
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            
        MDFillRoundFlatButton:
            text: "Ignora"
            font_size: 32
            font_name: "assets/font/computer-says-no.ttf"
            pos_hint: {"center_x": 0.3, "center_y": 0.4}
            on_release: root.process_choice('ignore')
            
        MDFillRoundFlatButton:
            text: "Responde"
            font_size: 32
            font_name: "assets/font/computer-says-no.ttf"
            pos_hint: {"center_x": 0.7, "center_y": 0.4}
            on_release: root.process_choice('respond')
        
        Image:
            source: "assets/images/cyberquest_name.png"
            size_hint: (None, None)
            size: dp(100), dp(45)
            pos_hint: {"center_x": 0.5, "center_y": 0.06}


<WonPage>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "winner_page"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Mandou bem!"
            font_style: "H4"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}

        MDLabel:
            id: score_label
            text: "Pontuação:"
            font_size: 36
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.7}


        MDLabel:
            text: "Você completou com sucesso o CyberQuest!"
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 15

        MDRoundFlatButton:
            text: "Jogar de novo"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.48}
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            on_release: app.reset_game()

        Image:
            source: "assets/images/cyberquest_logo.png"
            size_hint: (20, 20)
            pos_hint: {"center_x": 0.5, "center_y": 0.2}

<LostPage>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    name: "lost_page"

    FloatLayout:
        size: root.width, root.height

        MDLabel:
            text: "Não foi dessa vez!"
            font_style: "H4"
            font_size: 42
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.8}

        MDLabel:
            id: score_label
            text: "Pontuação:"
            font_size: 38
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.7}

        MDLabel:
            text: "Boa sorte na próxima vez. Continue aprendendo e tentando!"
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            halign: "center"
            pos_hint: {"center_x": 0.5, "center_y": 0.6}
            padding: 15

        MDRoundFlatButton:
            text: "Jogar de novo"
            size_hint: None, None
            pos_hint: {"center_x": 0.5, "center_y": 0.48}
            font_size: 30
            font_name: "assets/font/computer-says-no.ttf"
            on_release: app.reset_game()

        Image:
            source: "assets/images/cyberquest_logo.png"
            size_hint: (None, None)
            size: (dp(400), dp(400))
            pos_hint: {"center_x": 0.5, "center_y": 0.2}